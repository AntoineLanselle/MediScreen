<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>MediScreen - Patient Details</title>
<link rel="stylesheet" type="text/css" href="/css/styles.css" />
</head>

<body>

	<div class="container">
	
		<h1>Application MediScreen</h1>
		
		<form method="GET" action="/patient" >
  			<button type="submit" formmethod="GET"> &lt;- Back to patients list</button>
  		</form>
  		
  		<form method="POST" th:action="@{/patient/delete/{id}(id=${patientBean.id})}">
			<button name="deletePatient" type="submit" formmethod="POST">Delete</button>
		</form>

		<form method="POST" th:object="${patientBean}">

			<div class="form-left">
			
				<div class="input">
					<label for="given">Firstname*</label> 
					<input class="sec-2" name="given" type="text" placeholder="Firstname" th:value="${patientBean.given}" th:field="*{given}" required />
					<p class="error" th:if="${#fields.hasErrors('given')}" th:errors="*{given}"></p>
				</div>

				<div class="input">
					<label for="family">Lastname*</label> 
					<input class="sec-2" name="family" type="text" placeholder="Lastname" th:value="${patientBean.family}" th:field="*{family}"  required />
					<p class="error" th:if="${#fields.hasErrors('family')}" th:errors="*{family}"></p>
				</div>

				<div class="input">
					<label for="dob">Date Of Birth*</label> 
					<input class="sec-2" name="dob" type="date" th:value="${#temporals.format(patientBean.dob, 'yyyy-MM-dd')}" th:field="*{dob}" required />
					<p class="error" th:if="${#fields.hasErrors('dob')}" th:errors="*{dob}"></p>
				</div>
	
				<fieldset th:switch="${patientBean.sex}">
					<legend>Gender*</legend>
					<div th:case="F">
						<input class="sec-2" id="sexChoice1" name="sex" type="radio" value="F" th:field="*{sex}" checked required />
						<label for="sexChoice1">Female</label> 
						<input class="sec-2" id="sexChoice2" name="sex" type="radio" value="M" th:field="*{sex}" required /> 
						<label for="sexChoice2">Male</label> 
					</div>
					<div th:case="M">
						<input class="sec-2" id="sexChoice1" name="sex" type="radio" value="F" th:field="*{sex}" required />
						<label for="sexChoice1">Female</label> 
						<input class="sec-2" id="sexChoice2" name="sex" type="radio" value="M" th:field="*{sex}" checked required /> 
						<label for="sexChoice2">Male</label> 
					</div>
					<p class="error" th:if="${#fields.hasErrors('sex')}" th:errors="*{sex}"></p>
				</fieldset>
				
			</div>
			
			<div class="form-right">
			
				<div class="input">
					<label for="address">Address</label> 
					<input class="sec-2" name="address" type="text" placeholder="Address" th:value="${patientBean.address}" th:field="*{address}"/>
					<p class="error" th:if="${#fields.hasErrors('address')}" th:errors="*{address}"></p>
				</div>
	
				<div class="input">
					<label for="phone">Phone Number</label> 
					<input class="sec-2" name="phone" type="text" placeholder="012-345-6789" th:value="${patientBean.phone}" th:field="*{phone}" />
					<p class="error" th:if="${#fields.hasErrors('phone')}" th:errors="*{phone}"></p>
				</div>
				
			</div>

			<div class="error" th:if="${param.success}">
				<p>Modifications successfully done!</p>
			</div>
			
			<p>Fields marked with (*) are mandatory</p>
			
			<button name="patientBean" type="submit" formmethod="POST">Modify</button>

		</form>
		
		<div>
		
			<form method="GET" th:action="@{/patient/{id}/notes/add(id=${patientBean.id})}">
				<button name="addNotes" type="submit" formmethod="GET">Add new notes</button>
			</form>
						
			<div th:each="notes: ${notesPatient}">
			
				<ul>
					<li th:text="${notes.notesId}"></li>
					<li th:text="${notes.patId}"></li>
					<li th:text="${notes.dateTimeNote}"></li>
					<li th:text="${notes.e}"></li>
					<li>
						<form method="GET" th:action="@{/patient/notes/{id}(id=${notes.notesId})}">
							<button name="updateNotes" type="submit" formmethod="GET">Update</button>
						</form>
					</li>
					<li>
						<form method="POST" th:action="@{/patient/{patId}/notes/delete/{notesId}(notesId=${notes.notesId}, patId=${patientBean.id})}">
							<button name="deleteNotes" type="submit" formmethod="POST">Delete</button>
						</form>
					</li>
				</ul>

			</div>
		
		</div>
		
	</div>
	
</body>
</html>